# CNN для классификации CIFAR-10

## Установка зависимостей в виртуальное окружение
python -m venv myenv  
myenv\Scripts\activate.bat  
(myenv) pip install -r requirements.txt  

## Структура проекта
/tests - директория с тестовыми вариантами нейронных сетей  
/tests/models - обученные модели для каждого варианта  

– Файл python с именем train.py, который не принимает аргументов и запускает ваш
обучающий код на официальном наборе данных для обучения  
– Файл python с именем test.py, который не принимает аргументов и запускает ваш код
вывода на официальном тестовом наборе данных.  

## Описание вариантов сети и результатов тестирования
### CNN #1
cnn_1.py - классическая сверточная сеть с двумя сверточными слоями и тремя линейными. Параметры слоев брались из практических работ.
#### Результаты
Суммарная точность: 65.65%  
Точность класса airplane: 66.80%  
Точность класса automobile: 81.50%  
Точность класса bird: 53.00%  
Точность класса cat: 36.20%  
Точность класса deer: 62.70%  
Точность класса dog: 60.20%  
Точность класса frog: 72.70%  
Точность класса horse: 71.00%  
Точность класса ship: 74.30%  
Точность класса truck: 78.10%  

### CNN #2
cnn_2.py  
- добавлен слой self.pool2 = nn.MaxPool2d(2, 2)

#### Результаты
Суммарная точность: 66.23%  
Точность класса airplane: 59.20%  
Точность класса automobile: 80.70%  
Точность класса bird: 62.60%  
Точность класса cat: 50.00%  
Точность класса deer: 56.40%  
Точность класса dog: 45.70%  
Точность класса frog: 76.20%  
Точность класса horse: 72.40%  
Точность класса ship: 88.90%  
Точность класса truck: 70.20%  

#### Вывод
Суммарная точность ненамного, но выросла

### CNN #3
cnn_3.py - результирующий вариант проведенных экспериментов  
- убран transforms.RandomCrop(32, padding=4) из аугментации, т.к. удаление 4 пикселей из 32 существенно меняет картинку;
- добавлены transforms.RandomRotation(15), transforms.ColorJitter(), transforms.RandomGrayscale() в аугментацию;
- добавлен сверточный слой, удален один линейный, размер ядра сверток уменьшен, т.к. 5 px слишком большой размер для маленькой картинки;

#### Результаты
Суммарная точность: 66.86%  
Точность класса airplane: 65.40%  
Точность класса automobile: 84.70%  
Точность класса bird: 50.10%  
Точность класса cat: 48.20%  
Точность класса deer: 66.00%  
Точность класса dog: 55.70%  
Точность класса frog: 77.00%  
Точность класса horse: 70.30%  
Точность класса ship: 80.10%  
Точность класса truck: 71.10%  

#### Вывод
Суммарная точность ненамного, но выросла, однако видно направление работы: подбор параметров слоев для конкретного датасета


### CNN #4
cnn_4.py - результирующий вариант проведенных экспериментов  
- добавлен LR Scheduler;
- в качестве валидационного датасета используем тестовый;
- подобраны параметры сверточных и линейных слоев, добавлен небольшой padding;
- в файл test.py дополнительно добавлен вывод статистики неправильно распознанных классов, из которого можно увидеть, какие классы с какими сеть плохо классифицирует, анпример собаки и коты различаются плохо.
  
#### Результаты
Суммарная точность: 80.39%  
Точность класса airplane: 83.80%    
- automobile: 1.40  
- bird: 3.90
- cat: 1.20
- deer: 1.40
- dog: 0.10
- frog: 0.40
- horse: 1.50
- ship: 4.40
- truck: 1.90
Неправильно распознано: 16.20%     

Точность класса automobile: 92.20%  
- airplane: 1.30
- bird: 0.20
- cat: 0.30
- deer: 0.30
- frog: 0.30
- horse: 0.20
- ship: 1.10
- truck: 4.10
Неправильно распознано: 7.80%

Точность класса bird: 72.70%
- airplane: 6.20
- automobile: 0.80
- cat: 2.50
- deer: 6.70
- dog: 4.50
- frog: 3.20
- horse: 2.70
- ship: 0.50
- truck: 0.20
Неправильно распознано: 27.30%  

Точность класса cat: 57.20%  
- airplane: 2.00
- automobile: 0.70
- bird: 6.90
- deer: 4.90
- dog: 17.30
- frog: 4.50
- horse: 4.80
- ship: 1.10
- truck: 0.60
Неправильно распознано: 42.80%  

Точность класса deer: 80.10%  
- airplane: 1.40
- automobile: 0.30
- bird: 5.10
- cat: 2.60
- dog: 2.20
- frog: 3.00
- horse: 4.30
- ship: 0.80
- truck: 0.20
Неправильно распознано: 19.90%  

Точность класса dog: 74.10%  
- airplane: 0.70
- automobile: 0.20
- bird: 4.20
- cat: 11.80
- deer: 3.40
- frog: 1.00
- horse: 3.40
- ship: 0.40
- truck: 0.80
Неправильно распознано: 25.90%  

Точность класса frog: 84.50%  
- airplane: 0.80
- automobile: 0.90
- bird: 3.40
- cat: 5.30
- deer: 2.50
- dog: 1.50
- horse: 0.40
- ship: 0.40
- truck: 0.30
Неправильно распознано: 15.50%  

Точность класса horse: 86.30%  
- airplane: 0.60
- automobile: 0.10
- bird: 3.00
- cat: 2.00
- deer: 3.30
- dog: 3.90
- frog: 0.50
- ship: 0.10
- truck: 0.20
Неправильно распознано: 13.70%  

Точность класса ship: 88.40%  
- airplane: 5.50
- automobile: 3.00
- bird: 0.60
- cat: 0.30
- deer: 0.20
- dog: 0.30
- frog: 0.30
- horse: 0.60
- truck: 0.80
Неправильно распознано: 11.60%  

Точность класса truck: 84.60%  
- airplane: 3.90
- automobile: 5.10
- bird: 0.80
- cat: 0.60
- deer: 0.20
- dog: 0.10
- frog: 0.10
- horse: 1.30
- ship: 3.30
Неправильно распознано: 15.40%  
